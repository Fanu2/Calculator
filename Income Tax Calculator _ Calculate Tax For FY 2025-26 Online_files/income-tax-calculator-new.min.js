let FINANCIAL_YEAR_MAP={YEAR_2025_26:{value:1,name:"YEAR_2025_26"},YEAR_2024_25:{value:2,name:"YEAR_2024_25"}},AGE_GROUP={BELOW_60:{value:1,key:"BELOW_SIXTY"},BETWEEN_60_80:{value:2,key:"BELOW_EIGHTY"},ABOVE_80:{value:3,key:"ABOVE_EIGHTY"}},CITY_TYPE={METRO:1,NON_METRO:2},HOUSE={SELF_OWNED:1,RENTED:2},INCOME_TYPE={SALARY:1,SELF_EMPLOYED:2},SCREEN_TYPE={BASIC_DETAIL:1,INCOME_DETAIL:2,DEDUCTION:3,OUTPUT:4},newRegimeSlab={YEAR_2025_26:[{minIncome:0,maxIncome:4e5,taxPercentage:0},{minIncome:4e5,maxIncome:8e5,taxPercentage:.05},{minIncome:8e5,maxIncome:12e5,taxPercentage:.1},{minIncome:12e5,maxIncome:16e5,taxPercentage:.15},{minIncome:16e5,maxIncome:2e6,taxPercentage:.2},{minIncome:2e6,maxIncome:24e5,taxPercentage:.25},{minIncome:24e5,maxIncome:1/0,taxPercentage:.3}],YEAR_2024_25:[{minIncome:0,maxIncome:3e5,taxPercentage:0},{minIncome:3e5,maxIncome:7e5,taxPercentage:.05},{minIncome:7e5,maxIncome:1e6,taxPercentage:.1},{minIncome:1e6,maxIncome:12e5,taxPercentage:.15},{minIncome:12e5,maxIncome:15e5,taxPercentage:.2},{minIncome:15e5,maxIncome:1/0,taxPercentage:.3}]},taxRebate={NEW_REGIME:{YEAR_2024_25:{rebateAmount:25e3,uptoIncome:7e5},YEAR_2025_26:{rebateAmount:6e4,uptoIncome:12e5}},OLD_REGIME:{YEAR_2024_25:{rebateAmount:25e3,uptoIncome:7e5},YEAR_2025_26:{rebateAmount:6e4,uptoIncome:12e5}}},oldRegimeTaxSlabs={BELOW_SIXTY:[{minIncome:0,maxIncome:25e4,taxPercentage:0},{minIncome:25e4,maxIncome:5e5,taxPercentage:.05},{minIncome:5e5,maxIncome:1e6,taxPercentage:.2},{minIncome:1e6,maxIncome:1/0,taxPercentage:.3}],BELOW_EIGHTY:[{minIncome:0,maxIncome:3e5,taxPercentage:0},{minIncome:3e5,maxIncome:5e5,taxPercentage:.05},{minIncome:5e5,maxIncome:1e6,taxPercentage:.2},{minIncome:1e6,maxIncome:1/0,taxPercentage:.3}],ABOVE_EIGHTY:[{minIncome:0,maxIncome:5e5,taxPercentage:0},{minIncome:5e5,maxIncome:1e6,taxPercentage:.2},{minIncome:1e6,maxIncome:1/0,taxPercentage:.3}]},standardDeductionNewRegime=75e3,standardDeductionOldRegime=5e4,healthInsuranceDeductionLimit=25e3,parentsHealthInsuranceDeductionLimit=5e4;var chart,chartConfig,currentStep=SCREEN_TYPE.BASIC_DETAIL,financialYear=FINANCIAL_YEAR_MAP.YEAR_2025_26,ageGroup=AGE_GROUP.BELOW_60,city=CITY_TYPE.METRO,house=HOUSE.SELF_OWNED,incomeType=INCOME_TYPE.SALARY,grossSalary=0,otherIncome=0,deduction80C=0,deduction80D=0,deduction80CCD1B=0,deduction80CCD1=0,deduction80CCD2=0,deduction80E=0,deduction80G=0,otherDeduction=0,healthInsurance=0,parentHealthInsurance=0,calculatedTax={newRegime:{taxPayable:0,taxDeduction:0,taxableIncome:0,totalDeduction:0},oldRegime:{taxPayable:0,taxDeduction:0,taxableIncome:0,totalDeduction:0}};function checkValidInputs(e){if(e==SCREEN_TYPE.DEDUCTION&&grossSalary<=0)return e=document.querySelector('input[name="basic_salary"]'),showError(e,"This field is required"),!1;return!0}function goToStep(e){var t,a;e==SCREEN_TYPE.OUTPUT?(updateInputFields(e),calculateIncomeTax()):updateInputFields(e),checkValidInputs(e)&&(t=document.querySelector("#form-section-"+currentStep),a=document.querySelector("#form-section-"+e),t&&a&&(t.classList.add("hidden"),a.classList.remove("hidden")),updateStepper(currentStep=e))}function updateStepper(a){var e=document.querySelectorAll(".cal-tax-exemption .step-lists ul li");e.forEach((e,t)=>{t<a-1?e.classList.add("completed"):e.classList.remove("completed"),e.classList.remove("active")}),a==SCREEN_TYPE.OUTPUT?document.querySelector(".re-calculate").classList.remove("hidden"):(document.querySelector(".re-calculate").classList.contains("hidden")||document.querySelector(".re-calculate").classList.add("hidden"),e[a-1].classList.add("active"))}function updateInputFields(e){switch(e-1){case SCREEN_TYPE.BASIC_DETAIL:let t=parseInt(document.querySelector('input[name="assessment_years"]').dataset.value),a=(financialYear=Object.values(FINANCIAL_YEAR_MAP).find(e=>e.value==t),parseInt(document.querySelector('input[name="user_age"]').dataset.value));ageGroup=Object.values(AGE_GROUP).find(e=>e.value==a),incomeType=parseInt(document.querySelector('input[name="occupation"]').dataset.value);var n=document.querySelector(".basic_salary_wrapper label");incomeType===INCOME_TYPE.SELF_EMPLOYED?n.innerText="Self-Employed Income":n.innerText="Income from Salary";break;case SCREEN_TYPE.INCOME_DETAIL:grossSalary=parseFloat(document.querySelector('input[name="basic_salary"]').dataset.value||0),otherIncome=parseFloat(document.querySelector('input[name="incomeOnInterestSaving"]').dataset.value||0)+parseFloat(document.querySelector('input[name="interestFromDeposit"]').dataset.value||0)+parseFloat(document.querySelector('input[name="incomFromRental"]').dataset.value||0)+parseFloat(document.querySelector('input[name="otherIncome"]').dataset.value||0);break;case SCREEN_TYPE.DEDUCTION:deduction80C=parseFloat(document.querySelector('input[name="ppf"]').dataset.value||0)+parseFloat(document.querySelector('input[name="fixedDeposit"]').dataset.value||0)+parseFloat(document.querySelector('input[name="elss"]').dataset.value||0)+parseFloat(document.querySelector('input[name="termInsurance"]').dataset.value||0)+parseFloat(document.querySelector('input[name="deduction80CCD1"]').dataset.value||0),healthInsurance=parseFloat(document.querySelector('input[name="deduction80D"]').dataset.value||0),parentHealthInsurance=parseFloat(document.querySelector('input[name="healthInsParentInput"]').dataset.value||0),deduction80D=(healthInsurance>healthInsuranceDeductionLimit?healthInsuranceDeductionLimit:healthInsurance)+(parentHealthInsurance>parentsHealthInsuranceDeductionLimit?parentsHealthInsuranceDeductionLimit:parentHealthInsurance),deduction80CCD2=incomeType==INCOME_TYPE.SALARY?parseFloat(document.querySelector('input[name="deduction80CCD2"]').dataset.value||0):0,deduction80CCD1B=parseFloat(document.querySelector('input[name="deduction80CCD1B"]').dataset.value||0),deduction80E=parseFloat(document.querySelector('input[name="educationLoanInterest"]').dataset.value||0)+parseFloat(document.querySelector('input[name="homeLoanInterestForSelfOccupied"]').dataset.value||0)+parseFloat(document.querySelector('input[name="homeLoanInterestForRented"]').dataset.value||0),deduction80G=parseFloat(document.querySelector('input[name="donationCharity"]').dataset.value||0),otherDeduction=parseFloat(document.querySelector('input[name="otherDeduction"]').dataset.value||0)}}function calculateIncomeTax(){calculatedTax.newRegime=calculateNewRegimeTax(),calculatedTax.oldRegime=calculateOldRegimeTax(),displayOldRegimeOutput(),updateResultUI(calculatedTax.oldRegime)}function displayOldRegimeOutput(){var e=document.querySelectorAll(".tax-regime-switch li");e[0].classList.add("active"),e[1].classList.remove("active")}function updateResultUI(e){DrawPieChart(e),document.querySelector("#taxableIncome .bold").innerHTML=commaSeparated(e.taxableIncome),document.querySelector("#deduction .bold").innerHTML=commaSeparated(e.totalDeduction),document.querySelector("#taxPayable .bold").innerHTML=commaSeparated(e.taxPayable);e=calculatedTax.oldRegime.taxPayable-calculatedTax.newRegime.taxPayable;document.querySelector(".result-note").innerHTML=0!=e?`You should opt for the <span class='bold'>${e<0?"Old Tax Regime":"New Tax Regime"}</span> as you would end up paying <span class='semibold'>&#x20b9;${commaSeparated(Math.abs(e))+" lesser"} </span> as tax in this regime`:"You would end up paying the same tax in both the regimes."}function calculateOldRegimeTax(){let e=grossSalary+otherIncome,t=0;incomeType==INCOME_TYPE.SALARY&&(e=Math.max(e-standardDeductionOldRegime,0),t+=standardDeductionOldRegime);var a=calculateTotalDeductionOldRegime(),n=(a>e?(t=e,e=0):(e=Math.max(e-a,0),t+=a),calculateTaxAsPerSlab(e,oldRegimeTaxSlabs[ageGroup.key]));return{taxPayable:(n+.04*n).toFixed(0),taxDeduction:a.toFixed(0),totalDeduction:t.toFixed(0),taxableIncome:e.toFixed(0)}}function calculateNewRegimeTax(){let e=grossSalary+otherIncome,t=0;let a=0;incomeType==INCOME_TYPE.SALARY&&(t=standardDeductionNewRegime,e=Math.max(e-standardDeductionNewRegime,0),(n=calculateTotalDeductionNewRegime())>e?(t+=e,e=0):(e-=n,t+=n)),e<=taxRebate.NEW_REGIME[financialYear.name].uptoIncome?a=0:(n=e-taxRebate.NEW_REGIME[financialYear.name].uptoIncome)<(a=calculateTaxAsPerSlab(e,newRegimeSlab[financialYear.name]))&&(a=n);var n=.04*a;return{taxPayable:(a+=n).toFixed(0),taxDeduction:0,totalDeduction:t.toFixed(0),taxableIncome:e.toFixed(0)}}function calculateTaxAsPerSlab(e,t){var a,n=0;for(a of t){if(e<=a.maxIncome)return n+=(e-a.minIncome)*a.taxPercentage;n+=(a.maxIncome-a.minIncome)*a.taxPercentage}}function calculateTotalDeductionNewRegime(){return 75e4<deduction80CCD2?75e4:deduction80CCD2}function calculateTotalDeductionOldRegime(){ageGroup.value==AGE_GROUP.BELOW_60.value&&(healthLimit=25e3);var e=(15e4<deduction80C?15e4:deduction80C)+((deduction80CCD1B=5e4<deduction80CCD1B?5e4:deduction80CCD1B)+(deduction80CCD2=75e4<deduction80CCD2?75e4:deduction80CCD2))+deduction80D+deduction80E+deduction80G+otherDeduction;return console.log(e),e}function commaSeparated(e){var t=(e=e.toString()).substring(e.length-3),e=e.substring(0,e.length-3);return""!=e&&(t=","+t),e.replace(/\B(?=(\d{2})+(?!\d))/g,",")+t}function DrawPieChart(e){var e=[e.taxableIncome,e.totalDeduction,e.taxPayable],t=document.getElementById("pieChart").getContext("2d");chart?(chartConfig.data.datasets[0].data=e,chart.update()):(chartConfig={type:"doughnut",data:{labels:["Taxable Income","Tax Deductions","Tax Payable"],datasets:[{backgroundColor:["#6880C8","#71B3FF","#D43FF7"],data:e,hoverBackgroundColor:["#6880C8","#71B3FF","#D43FF7"],weight:.5}]},options:{segmentShowStroke:!1,aspectRatio:2,responsive:!0,cutoutPercentage:60,legend:{display:!1,position:"bottom",labels:{boxWidth:6},usePointStyle:!0}}},chart=new Chart(t,chartConfig)),setTimeout(function(){$(".graphic-body").removeClass("img-loader"),$(".card-cta a, #invest_nps").on("click",function(e){trackCustomGa4Event("CTA click",{click_text:e.target.innerText,click_link:e.target.href})})},200)}document.querySelectorAll(".commen-btn").forEach(e=>{e.addEventListener("click",e=>{var t=currentStep+1;checkValidInputs(t)&&trackCustomGa4Event("CTA click",{click_text:"Step-"+currentStep+" "+e.target.innerText+" button",click_link:"NA"}),goToStep(t),window.scrollTo({top:0,behavior:"smooth"})})}),document.querySelectorAll(".back-button").forEach(e=>e.addEventListener("click",e=>{trackCustomGa4Event("CTA click",{click_text:"Step-"+currentStep+" "+e.target.innerText+" button",click_link:"NA"}),goToStep(currentStep-1),window.scrollTo({top:0,behavior:"smooth"})})),document.querySelectorAll(".re-calculate").forEach(e=>e.addEventListener("click",e=>{goToStep(SCREEN_TYPE.BASIC_DETAIL),window.scrollTo({top:0,behavior:"smooth"})})),document.querySelectorAll(".tax-regime-switch li").forEach(e=>e.addEventListener("click",e=>{var t=e.currentTarget;if(t){t.classList.add("active");t=t.nextElementSibling||t.previousElementSibling,t=(t&&t.classList.remove("active"),e.currentTarget.getAttribute("value"));if("oldRegime"===t)updateResultUI(calculatedTax.oldRegime);else{if("newRegime"!==t)throw"Invalid tax regime switch value";updateResultUI(calculatedTax.newRegime)}}trackCustomGa4Event("toggle",{click_text:e.target.innerText,click_link:"NA"})})),document.querySelectorAll(".assessment-div .dropdown-select li").forEach(e=>e.addEventListener("click",function(e){var t=document.querySelector(".assessment-div .label-tooltip");"2025-26"==e.target.textContent?t.dataset.originalTitle="ITR Filing due date is 31st July 2026":t.dataset.originalTitle="ITR Filing due date is 31st July 2025"})),document.querySelectorAll(".dropdown-select li").forEach(e=>e.addEventListener("click",function(e){trackCustomGa4Event("dropdown",{click_text:e.target.innerText,click_link:"NA"})})),$(".card-cta a, #invest_nps").on("click",function(e){trackCustomGa4Event("CTA click",{click_text:e.target.innerText,click_link:e.target.href})});